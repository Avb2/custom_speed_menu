//-----------------------------------------------------------------------------------
// <auto-generated>
//     This file was generated by the Robotmaster Processor Definition Editor (PDE).
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//-----------------------------------------------------------------------------------

namespace Robotmaster.Processor.Fanuc.Generated.Classes
{
    /// <summary>
    ///     This is the standard processor entry point, which is used to tie into the existing processor infrastructure.
    /// </summary>
    [global::Robotmaster.Processor.Core.Common.Attributes.DslVersionAttribute(31)]
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Robotmaster.ProcessorDefinitionEditor.GenerationServices", "10.0.71.24214")]
    internal sealed class MyProcessorPackageBehavior : global::Robotmaster.Processor.Core.Common.BaseClasses.ProcessorPackageBehaviorBase
    {
        private static readonly global::System.Type ProcessorEntryPointsType = global::System.Reflection.Assembly.GetExecutingAssembly().GetType("Robotmaster.Processor.Fanuc.ProcessorEntryPoints");

        private static readonly global::System.Action<global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IOperation, global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IPreProcessorContext> PreProcessorEntryPointAction = GetActionForTwoArgumentStaticMethodInType<global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IOperation, global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IPreProcessorContext>(ProcessorEntryPointsType, "RunPreProcessor");

        private static readonly global::System.Action<global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IOperation, global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IMainProcessorContext> MainProcessorEntryPointAction = GetActionForTwoArgumentStaticMethodInType<global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IOperation, global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IMainProcessorContext>(ProcessorEntryPointsType, "RunMainProcessor");

        private static readonly global::System.Action<global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IProgram, global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IPostProcessorContext> PostProcessorEntryPointAction = GetActionForTwoArgumentStaticMethodInType<global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IProgram, global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IPostProcessorContext>(ProcessorEntryPointsType, "RunPostProcessor");

        private readonly global::Robotmaster.Processor.Fanuc.Generated.Interfaces.IInitializationSettings initializationSettings;

        public MyProcessorPackageBehavior()
        {
            this.initializationSettings = global::Robotmaster.Processor.Fanuc.Generated.Classes.InitializationSettings.CreateInstance(this);
        }

        /// <summary>
        ///     This is the entry point to initialize the processor.
        /// </summary>
        protected override void Initialize()
        {
            this.SetupProcessorEntryPoints();
            this.LoadAllProcesses();
            this.LoadAllDeviceMenus();
        }

        /// <summary>
        ///     This is used to setup the processor entry points.
        /// </summary>
        private void SetupProcessorEntryPoints()
        {
            if (PreProcessorEntryPointAction != null)
            {
                this.initializationSettings.PreProcessor = PreProcessorEntryPointAction;
            }

            if (MainProcessorEntryPointAction != null)
            {
                this.initializationSettings.MainProcessor = MainProcessorEntryPointAction;
            }

            if (PostProcessorEntryPointAction != null)
            {
                this.initializationSettings.PostProcessor = PostProcessorEntryPointAction;
            }
        }

        /// <summary>
        ///     This is used to load all the processes.
        /// </summary>
        private void LoadAllProcesses()
        {
            this.initializationSettings.AddProcess<global::Robotmaster.Processor.Fanuc.Generated.Artifacts.Processes.Cutting>();
            this.initializationSettings.AddProcess<global::Robotmaster.Processor.Fanuc.Generated.Artifacts.Processes.Additive>();
            this.initializationSettings.AddProcess<global::Robotmaster.Processor.Fanuc.Generated.Artifacts.Processes.PlasmaCutting>();
            this.initializationSettings.AddProcess<global::Robotmaster.Processor.Fanuc.Generated.Artifacts.Processes.Welding>();
            this.initializationSettings.AddProcess<global::Robotmaster.Processor.Fanuc.Generated.Artifacts.Processes.ThermalSpraying>();
        }

        /// <summary>
        ///     This is used to load all the device menus.
        /// </summary>
        private void LoadAllDeviceMenus()
        {
            this.initializationSettings.AddDeviceMenu("MotionSettings");
            this.initializationSettings.AddDeviceMenu("ControllerSettings");
            this.initializationSettings.AddDeviceMenu("PickPlaceSettings");
        }

        private static global::System.Action<T1, T2> GetActionForTwoArgumentStaticMethodInType<T1, T2>(global::System.Type typeToExtractFrom, global::System.String methodName)
        {
            if (typeToExtractFrom == null)
            {
                return null;
            }

            global::System.Reflection.MethodInfo methodInfo = typeToExtractFrom.GetMethod(methodName, global::System.Reflection.BindingFlags.Public | global::System.Reflection.BindingFlags.NonPublic | global::System.Reflection.BindingFlags.Static, null, new global::System.Type[] { typeof(T1), typeof(T2) }, null);

            if (methodInfo == null)
            {
                return null;
            }

            return (global::System.Action<T1, T2>)methodInfo.CreateDelegate(typeof(global::System.Action<T1, T2>));
        }
    }
}
